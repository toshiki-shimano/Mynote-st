# 最強Excel

## 自身用初期設定

★ファイルを開くショートカットでいちいちバックステージはいらないので、ファイル⇒オプション⇒保存の中の「ファイルを開く度にバックステージを開かない」をチェック

## 便利

★一番下のステータスバーは、検算に使える（セル範囲をマウスで指定する）  
⇒関数を適応した後に、合計が合っているかなど

★関数を入力中に左を押すと左のセルに行ってしまう時
⇒関数入力中に左下を見ると入力となっている。これを「F2」を押して編集モードに切り替えればいい

## 初期設定

①Excelのオプションでフォントの種類を文字は、MS Pゴシックに。数字はArialに変更  
⇒オプションでArialに変えるだけで文字の適応がMS Pゴシックになる

②行の高さがMS pゴシックの標準（１１）は見にくいので、変更する。  
⇒左角の全体選択で行を１８～２０に変える（これは、游ゴシックの時は必要ない）  
⇒オプションでフォントのサイズを変えても余白は変わらないので注意  

③A1の行、列は使わない
⇒既に文字がある場合は列や行を挿入してしまう

④文字は左揃え、数字は右揃え  
⇒データ入力のミスに気付きやすい（数字が右揃えなのに左にきたらおかしい）  
🔶重要🔶：Excelの初期設定は、基本は最初からこの設定だが、表の見出しの部分は、数字でも左揃えになってしまう。その時は、必ず手動で左にする。また、見出しの中央揃えはしないこと。

⑤数字は、単位専用の独立した列を作成する、適切な区切りを設定する。  
⇒単位専用は、単位だけが書いてある列を作り出す。数字や、名前と一緒につけない

⑥内訳の項目にインデントを付ける（二つやり方がある）  
⇒階層ごと（ずらす階層ごと）に列を使い、最終的に幅寄せをする  
⇒ずらしたいセルを選択してインデントずらしをやる

⑦同じ役割の列を同じ幅にする  
⇒列を選択して右クリで列の幅を入力  
⇒列の境目の右をダブルクリックすると左の列幅と揃える

⑧見せるように罫線以外の線は消す(余分な罫線を省き、余計な箇所には罫線は引かない)
⇒リボン表示の「目盛線」をクリックすると消える。
⇒背景色を白にしても目盛線を消せる
🔶重要🔶：表全体選択してからまとめて編集した方が早い。リボンホームのフォントの引き出しから設定に入り、罫線を選ぶ。線の種類を選択してから場所をクリックする。
🔶重要🔶：罫線のルールは、上下は太め、中線は細め、**縦線は不要**、表に一番右に飾り列という余白用の列を置いても良し

⑨ベタ打ち数値入力を色付けし、計算式を黒にする（必ず会社の色分けルールを聞く）  
⇒数式中にベタ打ちを混ぜない。必ずセル同士の計算にすること。（NG:B4 + 100B4 + 100）
⇒リボンホームの検索と選択で数式を選択するとそのセルが分かる

⑩強調したいセルには背景色を付ける(なるべく薄い色を選択すること。できれば2色以内)  
⇒いちいちセル選択をするのではなく。必ずCtrlを使った選択を使う

## ルール

①列と行の非表示機能は絶対に使わない  
⇒使うなら代わりにグループ化を使う  
⇒リボンデータにあり。出来れば三層にとどめる

②セルの結合は行わず、「選択範囲内で中央」を選ぶ  
⇒セルを結合してしまうと表のコピーがうまくいかなかったり、列や行の挿入が難しくなる。
⇒リボンホームの配置の引き出しで横位置を選択範囲内で中央を選択する。
⇒ただし縦の場合はセル結合してからリボンホームの配置の方向を使う

③使わないセルは斜線を付ける  
⇒罫線を使うとセルをまたがった斜線を引けないので、図形の斜め線を使う。この時にAltを押しながらやると扱いやすい

④セルに必要に応じてコメントを付ける（リボン校閲）

⑤ファイル作成者の名前を削除する  
⇒バックステージビューを開いて、情報からブックの検査、ドキュメントを検査するで、検査をすると、個人情報が入っていると出るのでそれを削除する。

⑥🔶重要🔶：関数を使ったら必ず検算表を作る（特にsumifsやcountifsなど）
⇒検算に使える関数
・counta（countではない、空欄以外のセルの数を数える）

## 必須ショートカット

①右クリックを瞬間に出す  
⇒「shift + F10」

②現在の時間と日付  
⇒「Ctrl + セミコロン」は日付  
⇒「Ctrl + コロン」は時間

③すぐファイルを開く
⇒Ctrl + 「O」

④線を作成する際にAltを押しながらやるとぴったりに収めてくれる

⑤住所を出すときは、日本語入力で郵便番号を打って出す

⑥関数候補は、「@~」で打つと候補が出るので、tabキーで選択して、途中入力したら最後エンターで@は消える

⑦「Ctrl + F」で画面検索表示

## 便利キー

1. Altを押した状態でtabを何回か押すと今開いているファイルを選択できる。

2. shift + F3(関数表を開く)

3. Alt + enter(セルの中で改行)

4. F4 (＝で関数設定中に絶対参照にする)

5. Ctrl + shift + L(フィルターのオン/オフ)

6. F2でカーソル選択

## 基本操作

★周辺操作
◎頭に０を付けた数字を入れたい時は、シングルコーテを頭に付けて入力する（'001など）  
⇒先頭に「'」を付けた数値は文字列として認識される

### 自動付け足しと自動表示

★文字列の選択をして右クリでセルの書式設定をすると、表示形式があるのでそこで自動付け足しが出来る

◎全ての名前に様をつける  
⇒セルの書式設定の表示形式で「@ "様"」と入力すると、そのセルに全て後の「様」がくっ付く  
⇒00000と設定すると五ケタを超えるまで頭に０が付く

### シリアル値の計算

★「2019/01/23」や「8-1」(8月1日になる)ような日付に関する値が入力されると、シリアル値として認識される。この値は足したり引いたりすることが可能である。日付は1900/01/01をシリアル値１として基準が定まっている  
⇒2019/01/11 ｜10 | と打つとこの二つを足すと2019/01/21になる

★時間もそうで8:00と打つとシリアル値と認識される。２４時間が１とされるので、１２時間は0.5。６時間は0.25として表示される。この２４時間を時刻に掛けてその値を標準に戻すと、きれいな時間が出る  
⇒8:00|21:30|13:30|24|13.5では、２４と13:30を掛けると時刻表示で0:00と出るので、それをさらに数値を標準に変更する

### その他基本

★条件付き書式（リボンホーム）  
◎指定した書式も満たすセルにできる

◎条件付き書式でエラー探しができる  
⇒表全体を選択して、条件付き書式で新しいルールで指定したセルの書式を選ぶ。下の選択でエラーを選んで色を付けると、エラーで出た時に色を表示してくれる

◎条件付き書式のルールが分からない時は、範囲を選択してルールの管理を見ればわかる

◎「数式を使った書式にする」ではこんなことができる  
⇒「=MOD(ROW(), 2) = 1」を入れると、奇数のセルのみを対象にして、これに色を付けると奇数行のみに色を適用できる

★見出しの固定の為にウィンドウを固定する  
⇒スライドを始めたい行か列を指定してリボン表示でウィンドウを固定するを使うさせたい

## 印刷スキル

★印刷時に全ページに見出しを表示する方法（P69）  
⇒リボンページの印刷タイトルを使う

## イレブン関数

### ①SUM

★「shift + alt + =」でオートsum  
★「@su」と打つと候補が出る

### ②MAXとMIN

★個別選択をする時は、@maで出したら、マウスでCtrlを押しながら選択する

★引数に直接数値を入れることも可能
⇒=max(A2, 100)とやるとA2の値が１００より小さい時は、１００が表示される

🔶重要🔶：異常値のチェック
⇒ある数字以上のある数字以内に数がないといけない時に、範囲選択して、最大や最小を出してみると紛れているのが分かる

🔶重要🔶：maxifsとminifs
⇒条件を指定して最大値最小値を出せる。
⇒ =maxifs(A1:A10, A1:A10, "<101")
⇒ =MAXIFS(C3:E5, C3:E5, "<10000")
⇒ifのせいか、第二引数を被っても指定しないといけない。第三引数には、条件を入れる

### ③ROUND(セル範囲, 桁数)※範囲指定はできない

★「商品数」「人数」「店舗数」「価格」など小数点が基本的に付かない値に関しては、roundで四捨五入してやる
⇒引数の桁数は、小数点第1位はなら「１」、第2位なら「２」、小数点以下全て切り捨てなら「０」

### ④IFERROR(セル範囲, エラー時に表示する文字)

⇒割り算で計算される値の一部のセルが空欄になっていると、＃DIV/0というエラーになる。これだとわかりにくい時があるので、irerrorを使ってエラー表示を別の表示に変える

★= IFERROR(H4 / I4 / J4, "要確認")
⇒式がある箇所をiferrorで囲む
⇒どうしても計算がまだできない式などは、この関数で挟んでおくということ

### ⑤if

★ =if(論理式、真、偽)  
⇒=IF(E4 >40, "合格", "不合格")  
・e4が40より上なら合格

⇒=IF(H4 < 0, "N.M.", I4 /H4 - 1)  
・h4がマイナスなら、not meaing（計算不能）でマイナスではないなら計算をする

★ネスト（ネストのif文を書くときに少し文字が変な感じになるが、それはしょうがない）
⇒ネストしすぎも分かりにくいので、カラムごとに複数の簡単なif文に分けた方がいい（１００以下の列と東京か否かの列と合格か不合格かどうかの列）
⇒ =IF(D4 > 20, "合格", IF(E4 > 40, "合格", "不合格"))
・d4が20以上なら合格だが、20以下の場合、e4が40以上なら合格

⇒ =IF(AND(D4>20,E4>40),"合格","不合格")
・ d4が20より上で かつ e4が40より上なら、合格

### ⑥sumif

★条件を指定して合計を求める（特定の条件を満たす値のみを対象にして条件判定を行うか）  
⇒真ん中の引数が検索条件（どの値を元にするのか）。最初の引数は、検索条件を検索をする範囲、最後がsumをする範囲  
⇒検索元に＊データ＊など任意の0文字で検索もできる（?データ?は任意の1文字ずつ）

⇒=SUMIF(E4:E9,H4,F4:F9)
・h4にある８という数字が元、e4からe9の範囲に8があれば対象とし、対象となる合計範囲を足す（f4からf9）

### ⑦sumifs(最強の関数)

★複数の条件を満たす値のみ合計する（検索元が１２７個まで指定可能）
⇒=SUMIFS(D5:D10,B5:B10, H4, C5:C10, H5)  
⇒最初に合計したい範囲。次に検索元を照らす範囲。そして、検索元。複数の場合は、個の次に照らす範囲、検索元と繋げていく  

★🔶重要🔶：使う時は、「特定の期間内のデータ集計」と「特定の範囲以内のデータの集計」
⇒8月15日から8月20日の間など
⇒この式は、検索元のデータを>=8月15と入れておく。次にもう一つの検索元に<=8月20日と入れておくこともできるが
⇒=sumif(c5:c15, b5:b15, ">="&g4, b5:b15, "<="&g5)と""と＆を使っていれることも可能である。

#### クロス集計

=SUMIFS($F:$F,$B:$B,$I5,$D:$D,K$4,$E:$E,$J5)
・まず、fの列全てを合計範囲にする。bの列が照らす範囲で、検索元がi5という進め方でやっている
★🔶重要🔶：$をどこに付けるかが重要！幅跳びしてほしいものを＄を付けないし、伸縮してほしくないものは$を付ける

### ⑧countifとcountblank

★=countif(照らす範囲、検索元)
★=countblank(検索範囲)は、空欄のセルをカウントする
⇒=COUNTIF(C5:C12, "")ようにcountifで空欄を検索もできる

★=countif(e5:e12, "?*")は一文字以上の単語を検索
★数値だけをカウントするには普通のcountを使う

### ⑨countifs

★=countifs(照らす範囲、検索元、照らす範囲、検索元の連続)

★照らす範囲を一つだけにして、検索元を増やす手もある
=countifs(c4, $h$2, c4, $h$3)
・条件を書いておき（h2とh3）その条件に合うものをカウントして複写する

### ⑩vlookup

★見積表などに商品情報を入力する時に、型番や商品IDを入力したら自動的に商品名や価格が表示される仕組みを「表引き」という  
⇒=vlookup(検索元、照らす範囲、照らす範囲の何番目の列を参照するか)  
※垂直統合なので列を参照。  
※真ん中の引数の照らすデータをマスタデータという

⇒=VLOOKUP(B5, $B$14:$D$17, 2)  
・b5を検索元にして、次にデータ範囲を全て囲い、そのデータ範囲の左から対象となる番号を選ぶ
・もしマスタデータに対象がない時は#N/Aというエラーが出るので
⇒=IF(B5 <> "", VLOOKUP(B5,B$13:D$17,2,FALSE), "")としてもよい
🔶重要🔶：b5 <> ""で＜＞を使うとnot扱いになるので、セルが空欄ではない時という条件
🔶重要🔶：照らす範囲を絶対参照にしておけば、その行の間にセル挿入をして新しいデータを入れた時に、その範囲も照らす範囲に入る。逆に照らす範囲の外に追加してしまうと反映されないので注意

### ⑪eomonth

★「月末」の日付は=eomonth(開始日, 月数)で表示。最初の引数は起算の開始日を指定。
⇒第二引数は、「0」だと当月の月末
⇒第二引数は、「1」だと翌月の月末
⇒第二引数は、「-1」だと先月の月末

## わかりやすい関数

①PHONETIC関数
⇒フリガナを別のセルに表示すること
⇒高橋 悟｜     |この中にPHONETIC（E5）と入れるとフリガナが出る
