# 初級

## 前知識

★相対参照、絶対参照、複合参照（F4連続押しで切り替え可能）
⇒相対参照（アンカーを付けない）
⇒絶対参照（選択したセルの行と列共にアンカーがついて、絶対固定）
⇒複合参照（行か列、どちらかにアンカーが付いている）

## 心構え

★セルの入力内容チェックはキーボードのみで行うこと

★Altは使える！！
⇒「Alt」を押すとタブ選択をマウスを使わなくていい
⇒altと方向キーでタブを選び放題

★🔶重要🔶：作業する前に必ずファイルをコピーする
⇒一区切りついたり、作業を始める前にコピーをとっておく
⇒oldフォルダーを用意して、作業を始める前に最初の状態をコピーして１と名づける
⇒一区切りついたら、上書き保存ではなく、「名前を付けて保存」
⇒その際に、内容＿日付＿その日のバージョン番号がおススメ（売り上げ分析_20210521_1など）

★初での情報や数値は、出所列を作り、メモを残す
⇒各社決算書より、webサイトより（上付き文字を使う：セルを選択後、セルの書式設定で上付き文字をやる）

## 初期設定

★エンター後のセル移動を横に変えたい時は、オプションの「詳細設定」で下を変える

## 操作基礎

★「F2」で編集モードの時に「tabキー」で右移動

## ミスチェックの方法

★「F2」と「tabキー」を交互に連打（表が横に長い時）  
⇒左手でF2とtabに置いて、右手で矢印操作  
★「F2」と「enterキー」を交互に連打（表が縦に長い時）  
🔶重要🔶：ここで見るのは、参照の範囲がずれていたり、大きさがずれていないかを見る

★参照元のトレース  
⇒リボン数式の参照元のトレースでその計算がどうなっているかわかる  
⇒altを押した後に「m」を押して、「p」を押せばトレースを出来る  
⇒参照先になると、その値がどの値に影響を与えているか見られる

★データ確認用のグラフ  
◍折れ線グラフ  
⇒変に盛り上がっている箇所や、二つの線の相関に矛盾が無いかどうか  
⇒データ範囲を選択肢、挿入タブから折れ線グラフでマーカー付きを選ぶ

★スペルミスやタイプミスを防ぐ方法として、何度も使う票を違う独立したシートにまとめておき、各シートから参照する  
⇒全てのシートをベタ打ちにすると変更が合った場合に全て変更しなくてはいけない。

★🔶重要🔶：入力ミスを防ぐための手段として、「入力する」のではなく「選ばせる」  
⇒データタブでデータツールでデータの入力規則でリストにして、選ぶ文字を入れる  
⇒いっぺんに範囲指定で全てリストにすることもできる、さらに入力済みからリストを作成できる
⇒alt + ↓ でリストを展開できる
⇒🔶重要🔶：データリストを付けると、リスト以外のデータを入れられないが、リスト作成時に、エラーメッセージの「スタイル」を情報に変えると新しい入力もできる。入力すると条件を満たしてないと出るが、スタイルが停止ではなくあくまで情報なのでその後セットできる

## ショートカットキーとタッチパネル

★初級  
⇒🔺注意🔺:戻る、進めるのCtrlとzとyは手をほどいてきちんと確認しながらゆっくりやること  
⇒コピーからにペーストして、そのままCtrlで貼り付けオプションいける  
⇒飛び越え選択：shiftで範囲を選択したら、shiftを押しながらf8を押すとその範囲がセーブされ、次の選択ができる。また、範囲指定したらshiftを押しながらf8の繰り返し（基本shift押しっぱなし）  
⇒新規ブックを出す：「Ctrl」+ 「n」  
⇒名前を付けて保存：「F12」押すだけ  
⇒ブック間の移動：「Ctrl」「tab」  
⇒ブックを閉じる：「Ctrl」「w」  
⇒検索と置換：「Ctrl」「f」  
⇒ウィンドウを拡大縮小：「window」「↓」「↑」
⇒現在時刻：「Ctrl」「:」  
⇒現在日時：「Ctrl」「;」  
⇒🔶重要🔶：**セルの書式設定**：「Ctrl」+ 「１」（左キーを押しやすいのでCtrlを押して動いてないことを確認してから１を押す）  
⇒セルの書式設定のタブ移動は、「Ctrl」と「tab」  
⇒列全体選択：「Ctrl」「スペース」と行全体選択「shift」「スペース」  
⇒セルの挿入：「Ctrl」「shift」「セミコロン」（行全体が真上挿入、列全体が選択したセルの左にできる）  
⇒入力済みのセルからセルへ一気に飛ぶ：「Ctrl」「矢印方向」（ただし、範囲外になると最高列や最高行までいってしまうのでよく見て使うこと）（なので、ダミー入力値を入れることもある）  
⇒目盛線：「Alt」「w」「v」「g」  
⇒コピー：「Ctrl」「p」と詳細は「Alt」「p」「s」「p」

◍参照元のセルを選択。計算式があるセルで「Ctrl」「[」でその計算の参照されている範囲が分かる  
⇒「Alt」「m」「p」で参照元のトレース（式があるセルでやるとトレースが表示される）  
⇒「Alt」「m」「d」で参照先のトレース（式があるセルでやるとトレースが表示される）  
⇒「Alt」「m」「a」「a」で参照解除

★重要  
◍数値のカンマ区切り：「shift」「Ctrl」「１」  
⇒もちろんCtrlとスペースで列選択してから使うとよし  
◍％表示：「shift」「Ctrl」「５」  
◍小数点の桁数の増減：「Alt「h」「0」（桁数を左に）「9」（桁数を右に）  
⇒🔺注意🔺:テンが動くわけではなく桁数が増える  

◍フィルター：「Ctrl」「shift」「L」（同じコマンドで消せる）  
⇒その後「Alt」「↓」で開ける

◍ウィンドウ枠の固定：「Alt」「w」「f」  
⇒解除も同じ

◍🔶重要🔶：前と同じ動作をF4一つで出来る  
⇒選択範囲して、背景の色を変更したら、次どの範囲だろうとF4ですぐ塗れる

★範囲選択  
⇒「shift」を押しながら方向キー

★列幅の自動拡大  
⇒「Alt」「h」「o」「i」で選択したセルの幅を調整。「ほおい」と打てばこれは速い  
⇒もちろんshift選択してからいっぺんにできる

★セルのグループ化  
⇒解除のほうを覚える（「shift」「Alt」「←」）  
⇒グループ化は、「shift」「Alt」「→」

★セルを拡大縮小
⇒タッチパネルで境目をダブルタッチしてその範囲が枠に出たら、指を離さずスライド

★値がある所での全体選択
⇒数値があるセルで「Ctrl」+「A」

★折れグラフの出し方
⇒「Alt」「n」「n」「１」
⇒「Alt」「n」「c」「１」

## 学習

★他のシート値を参照する  

⇒vlookupなどで検索元や検索範囲を別のシートからも参照出来る  
⇒「商品!$b$4:$d$9」や「sheet1!~」のようにシート名と！を付けてからセル選択をする
・=VLOOKUP($B2, Sheet1!$B$2:D5, 2)
⇒b2を検索元にして、sheetq1にあるこの範囲を照らし、その2番目を反映

⇒🔺注意🔺:シートはともかく、他ブックの参照はやめる。自ブック単独で使用できるようにする。そのために、その他のシートの参照したい所をコピーして新たに使うこと。それか、**シートごと**コピーすれば安全
（他ブックを参照するには、[ブック名.xlsx]シート名!セル番地）
（=VLOOKUP($B5,'C:\excel\data\[見積作成_20160801_1.xlsx]商品'!$B$4:$D$9,2,FALSE)）
⇒他のブックへの参照があるかは、検索と置き換えで「[」角カッコを探す。そして。検索オプションでブック全体にして検索対象を数式にする

★何度も使うセルに名前を付ける  
⇒=SUM(フルーツ + G2)  
🔶重要🔶：名前を付けるシートを決めておく。シートは他のシートからも参照できるので、そこから参照できるようにする  
⇒名前を付けたセルは、数式タブの名前管理で見れる  
🔶重要🔶：数式タブより、名前の定義で値そのものに名前をつけられる。範囲はブック全体で、セル選択はないが、=0.08という値を消費税率と付ければ、どこでも消費税率という名前を入れると0.08という数字で計算ができる  
⇒ただし、第三者にわかりにくいということもあり、おすすめはしない。また、範囲は、ブック間ではなく、そのシート単体のほうがいい  

★検索と置換（Ctrlとf）  
⇒全て一度に置換ではなく、検索してから一つ一つ置換したほうがいい  
⇒置換後の文字列を空欄のままにしておくと、置換対象を削除できる（空欄にする）

## コピー＆ペースト（コピーをしてから「Alt」「h」「v」）

🔺注意🔺:意識すること  
①何をペーストしたいのかを意識する  
⇒「値」「書式」なのか  
⇒普通のコピーでは列幅はコピーされないので設定をやらないといけない

②表の書式を壊さずにペースト（値の貼り付け）  
◍[123]とあるマーク（V）：コピーしたセルの値のみを貼り付け  
◍[%123]とあるマーク（A）:値と表示形式のみ（コンマ区切り）  
◍[筆123]とあるマーク（E）:値と表示形式と背景色  

③書式貼り付け（その他貼り付けオプション）  
◍[％筆]とあるマーク（R）:値以外で、背景とコンマ区切り

③数式のみ（貼り付けの一覧）  
◍[fx]とあるマーク（F）  
🔺注意🔺:便利！セルの数式のコピーする場合、前に参照していたセルの位置も一緒に参照される  
⇒例えば、コピーしていたセルの数式が一つ飛ばしのセル二つを参照していたら、コピーした方も一つ飛ばしの参照になるので、分かっていないと貼り付ける意味がないし、正しく参照されない  
◍[%fx]とあるマーク（）:数式だけではなく、書式までもコピー

④除算貼り付けと乗算貼り付け  

◍除算貼り付け  
⇒ある値を選択して、その数値で選択範囲を割る。例えば、1000というセルをコピーして、次に1000で割りたいセル全体を選択して、そこに貼り付けオプションで演算で除算をすると、全て1000で割られる  
◍乗算貼り付けは、除算の掛け算版

⑤🔶重要🔶：列と行の入れ替え（マトリクス表）
⇒マトリクスになっている項目を簡単に列と行を入れ替えできる  
🔺注意🔺:貼り付けオプションで罫線を除くすべてを必ずチェックする（付けないと罫線がちらばってしまう）  
⇒コピーする範囲は、**表のタイトルは含めない**、あくまでもデータのみを選択する

## オートフィル

★セル選択したら、タッチパッドでそのセルのフィルの所で2回トントン叩くと、ターゲッティングされるので、引っ張れば連続したデータが得られる

◍色の付けたセルの下に色なしのセルを置いて、その二つを範囲選択してからフィルをすれば交互に色付けもできる

## 並び替えダイアログとフィルター機能

### 並び替え

🔺超注意🔺:業務上のデータは必ず取り分け保存をしてから使うこと  
🔺注意🔺:並べ替える範囲を関連なくある行だけ並び替えてしまうとレコードが変わってしまうので、関連のある全てのデータを範囲選択してからやること  
🔺超注意🔺:選択範囲に数式がある場合ぐちゃぐちゃになるかもしれない  
🔺注意🔺:Excelの並び替えは、行をレコードとして扱うので、その形の並べ方ではないと崩壊する（つまり列を主体として並び変える）なので、その場合は、コピーで列と行の入れ替えを行う

★shiftとCtrlと方向キーで一発選択  
⇒「Alt」「a」「s」「s」でレベル詳細へ  
⇒セルの選択範囲に項目があればその項目の優先順位を決めて、各列の並び替えができる  
（県別に揃えてから、その中で日付の新しい順など）

### フィルターとsubtotal関数

★特定のデータのみを集めたい時によく使う  
⇒フィルターは「shift」「Ctrl」「L」で表示し、「Alt」「↓」で窓を開く  
⇒「店舗列を東京のみ」「年度列を2019年のみ」「性別を男のみ」など  
🔺注意🔺:フィルター窓を開いた後に、スペースでチェックを外したり付けたり出来るが、日本語モードになっているとできない

🔶重要🔶：大量のデータから、東京に絞って、それを丸々その部分だけコピーもできる！ただし、同じシートの絞っている範囲のセルにコピーはできないので、そのフィルターでたたまれている範囲以外や別のシートに貼り付けること

🔶重要🔶：フィルターの中の数値をsumやcountしている場合、もちろんたたんでもデータが無くなるわけではないので数値は変わらない。もし、表示している数値だけを足し算したいなら、subtotalという関数がある
⇒=subtotal(計算方法, セル範囲)  
⇒セル範囲は、列全体ならE:Eなど  
⇒この引数の計算方法は、割り当てが決まっている  
◍「９」は足し算  
◍「２」はcount  
