# モデルにおける記法

* モデルに記述するということは、アプリケーション側に設定するということ
* マイグレーションファイルに記述するということは、DB側に設定するということ

## 検証（バリデーション）

⇒モデルには、マイグレーションファイルで出来るような検証（バリデーション）の仕組みが備わっている。`railsにおけるモデルの検証は、モデルのオブジェクトのレコードが更新、登録する前にモデルの検証を通し、エラーがあれば更新登録せず差し戻す`という流れになる。saveみたいに登録更新しないで、検証事態だけで通るかを判断するメソッドはvalid?  
⇒saveは自動で検証してくれるが、、してくれないものもある。(p143)

### 書き方～（ｐ１３６）

①名前やメールアドレスの空欄を無効＋文字数の長さを指定
validates :name, presence: true, length: { maximum: 20 }  
②自分で作ったメソッドを発動させ、制約をかける（formatを使う）（ｐ１４１）  
⇒いつもvalidatesを書くところに、単数形でvalidate :と打ち、自作のメソッドの名前を入れる  
⇒下にprivate空間を作り、そこにdefを作成。  
`errors.add(:name,  "にカンマを含めることはできません")  if  name&.include?(",")`
⇒errors.add(:name,  "にカンマを含めることはできません")  
＃次のif文がカスタマイズ対象（ボッチ演算は合った方がいいと思う。P142に説明あり）

③コールバック
⇒これを使い、名前無しなら「名前なし」と自動で入れることができる。vaildatesがあっても、before_validationでその制約がかかる前に名前を入れることができる。そして入れば、制約にもかからない

## 特殊対策

①csrf(シーサーフ)への対策  
`protect_from_forgery with: :exception`
